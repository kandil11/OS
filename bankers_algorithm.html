<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Banker's Algorithm Visualizer</title>
    <style>
        :root {
            --bg-color: #f5f5f7;
            --container-bg: white;
            --text-color: #333;
            --text-secondary: #666;
            --card-bg: #f9f9f9;
            --card-shadow: 0 2px 4px rgba(0,0,0,0.05);
            --border-color: #ddd;
        }

        [data-theme="dark"] {
            --bg-color: #1a1a1a;
            --container-bg: #2d2d2d;
            --text-color: #e0e0e0;
            --text-secondary: #b0b0b0;
            --card-bg: #3a3a3a;
            --card-shadow: 0 2px 4px rgba(0,0,0,0.3);
            --border-color: #555;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background: var(--bg-color);
            margin: 0;
            padding: 0;
            color: var(--text-color);
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .navbar {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      background-size: 200% 200%;
      padding: 20px 0;
      box-shadow: 0 8px 32px rgba(0,0,0,0.15);
      position: sticky;
      top: 0;
      z-index: 1000;
      border-radius: 0 0 30px 30px;
      margin-bottom: 20px;
      animation: gradientShift 8s ease infinite, slideDown 0.8s ease-out;
    }
    
    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    @keyframes slideDown {
      from {
        transform: translateY(-100%);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }
    .nav-container {
      max-width: 1200px;
      margin: 0 auto;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 0 30px;
      position: relative;
      gap: 40px;
      animation: fadeInUp 1s ease-out 0.3s both;
    }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    .theme-toggle {
        background: var(--container-bg);
        border: 3px solid #e74c3c;
        color: #e74c3c;
        padding: 12px 20px;
        border-radius: 30px;
        cursor: pointer;
        font-weight: bold;
        transition: all 0.3s ease;
        font-size: 1.1em;
        box-shadow: 0 3px 6px rgba(0,0,0,0.15);
        min-width: 120px;
        animation: bounceIn 1s ease-out 0.8s both, glow 2s ease-in-out infinite alternate;
        position: relative;
        overflow: hidden;
    }
    
    .theme-toggle::after {
        content: '';
        position: absolute;
        top: 50%;
        left: 50%;
        width: 0;
        height: 0;
        background: rgba(231, 76, 60, 0.3);
        border-radius: 50%;
        transform: translate(-50%, -50%);
        transition: all 0.3s ease;
    }
    
    .theme-toggle:hover {
        background: #e74c3c;
        color: white;
        transform: translateY(-3px) scale(1.05);
        box-shadow: 0 6px 12px rgba(231, 76, 60, 0.4);
        animation-play-state: paused;
    }
    
    .theme-toggle:hover::after {
        width: 100%;
        height: 100%;
    }
    
    @keyframes bounceIn {
      0% {
        opacity: 0;
        transform: scale(0.3) translateX(50px);
      }
      50% {
        opacity: 1;
        transform: scale(1.05) translateX(0);
      }
      70% {
        transform: scale(0.9) translateX(0);
      }
      100% {
        opacity: 1;
        transform: scale(1) translateX(0);
      }
    }
    
    @keyframes glow {
      from {
        box-shadow: 0 3px 6px rgba(0,0,0,0.15), 0 0 0 rgba(231, 76, 60, 0.4);
      }
      to {
        box-shadow: 0 3px 6px rgba(0,0,0,0.15), 0 0 20px rgba(231, 76, 60, 0.6);
      }
    }
    .nav-brand {
      color: white;
      font-size: 1.8em;
      font-weight: 800;
      text-decoration: none;
      text-shadow: 0 2px 4px rgba(0,0,0,0.3);
      letter-spacing: -0.5px;
      transition: all 0.3s ease;
      animation: pulse 2s ease-in-out infinite alternate;
    }
    .nav-brand:hover {
      transform: scale(1.05) rotate(2deg);
      text-shadow: 0 4px 8px rgba(0,0,0,0.4);
      animation-play-state: paused;
    }
    
    @keyframes pulse {
      from {
        text-shadow: 0 2px 4px rgba(0,0,0,0.3);
      }
      to {
        text-shadow: 0 4px 12px rgba(255,255,255,0.3);
      }
    }
    .nav-links {
      display: flex;
      gap: 15px;
      background: rgba(255,255,255,0.1);
      padding: 10px 15px;
      border-radius: 30px;
      backdrop-filter: blur(10px);
      transition: all 0.3s ease;
      animation: float 3s ease-in-out infinite;
    }
    
    .nav-links:hover {
      background: rgba(255,255,255,0.2);
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.2);
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0px); }
      50% { transform: translateY(-3px); }
    }
    .nav-link {
      color: white;
      text-decoration: none;
      padding: 12px 20px;
      border-radius: 30px;
      transition: all 0.3s ease;
      font-weight: 500;
      position: relative;
      overflow: hidden;
      animation: slideInFromLeft 0.6s ease-out forwards;
      opacity: 0;
    }
    
    .nav-link:nth-child(1) { animation-delay: 0.1s; }
    .nav-link:nth-child(2) { animation-delay: 0.2s; }
    .nav-link:nth-child(3) { animation-delay: 0.3s; }
    .nav-link:nth-child(4) { animation-delay: 0.4s; }
    .nav-link:nth-child(5) { animation-delay: 0.5s; }
    .nav-link:nth-child(6) { animation-delay: 0.6s; }
    .nav-link:nth-child(7) { animation-delay: 0.7s; }
    
    @keyframes slideInFromLeft {
      from {
        opacity: 0;
        transform: translateX(-50px);
      }
      to {
        opacity: 1;
        transform: translateX(0);
      }
    }
    .nav-link::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: left 0.5s;
    }
    .nav-link:hover::before {
      left: 100%;
    }
    .nav-link:hover {
      background: rgba(255,255,255,0.2);
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }
    .nav-link.active {
      background: rgba(255,255,255,0.3);
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }

        /* Mobile Menu Toggle Button */
        .mobile-menu-toggle {
            display: none;
            position: fixed;
            top: 20px;
            left: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            font-size: 1.5em;
            cursor: pointer;
            padding: 12px 15px;
            border-radius: 50px;
            z-index: 1001;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
            width: 50px;
            height: 50px;
            align-items: center;
            justify-content: center;
        }

        .mobile-menu-toggle:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0,0,0,0.4);
        }

        /* Mobile Overlay */
        .mobile-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1002;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .mobile-overlay.show {
            display: block;
            opacity: 1;
        }

        /* Mobile Sidebar */
        .mobile-sidebar {
            position: fixed;
            top: 0;
            left: -100%;
            width: 280px;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            z-index: 1003;
            transition: left 0.3s ease;
            overflow-y: auto;
            box-shadow: 4px 0 20px rgba(0,0,0,0.3);
            border-radius: 0 50px 50px 0;
        }

        .mobile-sidebar.open {
            left: 0;
        }

        .mobile-sidebar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }

        .mobile-sidebar-brand {
            color: white;
            font-size: 1.4em;
            font-weight: 800;
            text-decoration: none;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .mobile-close-btn {
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            font-size: 1.5em;
            cursor: pointer;
            padding: 8px 12px;
            border-radius: 25px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .mobile-close-btn:hover {
            background: rgba(255,255,255,0.2);
            border-color: rgba(255,255,255,0.5);
            transform: scale(1.05);
        }

        .mobile-nav-links {
            padding: 20px 0;
        }

        .mobile-nav-link {
            display: block;
            color: white;
            text-decoration: none;
            padding: 15px 20px;
            font-weight: 500;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
            margin: 2px 0;
        }

        .mobile-nav-link:hover,
        .mobile-nav-link.active {
            background: rgba(255,255,255,0.2);
            border-left-color: white;
            transform: translateX(5px);
        }

        .mobile-theme-toggle {
            margin: 20px;
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            padding: 12px 20px;
            border-radius: 40px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            text-align: center;
            backdrop-filter: blur(10px);
            display: block;
            width: calc(100% - 40px);
        }

        .mobile-theme-toggle:hover {
            background: rgba(255,255,255,0.2);
            border-color: rgba(255,255,255,0.5);
            transform: scale(1.02);
        }

        .container {
            max-width: 1200px;
            margin: 20px auto;
            background: var(--container-bg);
            padding: 20px;
            border-radius: 30px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            transition: background-color 0.3s ease;
        }
        h1 {
            text-align: center;
            margin-bottom: 15px;
            color: #e74c3c;
            font-size: 1.8em;
        }
        .input-section {
            margin-bottom: 20px;
        }
        .matrix-input {
            margin: 15px 0;
            overflow-x: auto;
        }
        table {
            border-collapse: collapse;
            margin: 8px 0;
            width: 100%;
        }
        th, td {
            border: 1px solid var(--border-color);
            padding: 6px;
            text-align: center;
            font-size: 0.9em;
        }
        th {
            background-color: var(--card-bg);
            color: var(--text-color);
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        input[type="number"] {
            width: 70px;
            padding: 6px 10px;
            text-align: center;
            background: var(--container-bg);
            color: var(--text-color);
            border: 2px solid var(--border-color);
            border-radius: 30px;
            transition: all 0.3s ease;
            font-size: 13px;
            font-weight: 500;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        input[type="number"]:focus {
            outline: none;
            border-color: #e74c3c;
            box-shadow: 0 0 0 3px rgba(231, 76, 60, 0.1), 0 4px 12px rgba(0,0,0,0.1);
            transform: translateY(-1px);
        }
        
        input[type="number"]:hover {
            border-color: #e74c3c;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }
        button {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            margin: 8px 0;
            transition: background 0.3s ease;
            font-size: 0.9em;
        }
        button:hover {
            background: #c0392b;
        }
        .result-section {
            margin-top: 20px;
            padding: 15px;
            border: 1px solid var(--border-color);
            border-radius: 30px;
            background: var(--card-bg);
            transition: background-color 0.3s ease;
        }
        .safe-sequence {
            font-weight: bold;
            color: #27ae60;
        }
        .unsafe {
            color: #e74c3c;
        }
        .step-by-step {
            margin-top: 15px;
            padding: 12px;
            background: var(--container-bg);
            border-radius: 30px;
            box-shadow: var(--card-shadow);
            transition: background-color 0.3s ease;
            max-height: 300px;
            overflow-y: auto;
        }
        .step {
            margin: 8px 0;
            padding: 8px;
            border-left: 3px solid #e74c3c;
            background: var(--card-bg);
            transition: background-color 0.3s ease;
            font-size: 0.9em;
        }
        h3 {
            color: #e74c3c;
        }
        .back-button {
            position: relative;
            display: inline-block;
            background: #e74c3c;
            color: white;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 30px;
            font-weight: bold;
            transition: background 0.3s ease;
            margin-bottom: 20px;
        }
        .back-button:hover {
            background: #c0392b;
        }
        .process-inputs {
            margin-top: 15px;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 12px;
        }
        .process-card {
            border: 1px solid var(--border-color);
            padding: 12px;
            border-radius: 30px;
            background: var(--card-bg);
            box-shadow: var(--card-shadow);
            transition: background-color 0.3s ease;
        }
        .process-card h3 {
            margin-top: 0;
            margin-bottom: 12px;
            color: #e74c3c;
            font-size: 1.1em;
        }
        .resource-input {
            margin: 8px 0;
        }
        .resource-input label {
            display: block;
            margin-bottom: 5px;
            color: var(--text-secondary);
        }
        .resource-input input, .resource-input select {
            width: 100%;
            padding: 12px 20px;
            border: 2px solid var(--border-color);
            border-radius: 30px;
            box-sizing: border-box;
            background: var(--container-bg);
            color: var(--text-color);
            transition: all 0.3s ease;
            font-size: 14px;
            font-weight: 500;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .resource-input select {
            appearance: none;
            cursor: pointer;
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%23e74c3c' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e");
            background-repeat: no-repeat;
            background-position: right 15px center;
            background-size: 16px;
            padding-right: 45px;
        }
        
        .resource-input input:focus, .resource-input select:focus {
            outline: none;
            border-color: #e74c3c;
            box-shadow: 0 0 0 3px rgba(231, 76, 60, 0.1), 0 4px 12px rgba(0,0,0,0.1);
            transform: translateY(-1px);
        }
        
        .resource-input input:hover, .resource-input select:hover {
            border-color: #e74c3c;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }
        .available-resources {
            background: var(--container-bg);
            padding: 15px;
            border-radius: 30px;
            margin-bottom: 20px;
            box-shadow: var(--card-shadow);
            transition: background-color 0.3s ease;
        }
        .available-resources h3 {
            margin-top: 0;
        }
        .resource-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
        }
        .result-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: var(--container-bg);
            box-shadow: var(--card-shadow);
            transition: background-color 0.3s ease;
        }
        .result-table th, .result-table td {
            padding: 12px;
            text-align: center;
            border: 1px solid var(--border-color);
        }
        .result-table th {
            background-color: #e74c3c;
            color: white;
            font-weight: bold;
        }
        .result-table tr:nth-child(even) {
            background-color: var(--card-bg);
        }
        .result-table tr:hover {
            background-color: var(--card-bg);
            opacity: 0.8;
        }
        .matrix-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            background: var(--container-bg);
            transition: background-color 0.3s ease;
        }
        .matrix-table th, .matrix-table td {
            padding: 8px;
            text-align: center;
            border: 1px solid var(--border-color);
        }
        .matrix-table th {
            background-color: var(--card-bg);
            font-weight: bold;
            color: var(--text-color);
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .matrix-title {
            color: #e74c3c;
            margin: 20px 0 10px 0;
            font-size: 1.1em;
        }
        .safe {
            color: #27ae60;
            font-weight: bold;
        }
        .unsafe {
            color: #e74c3c;
            font-weight: bold;
        }
        .step-number {
            font-weight: bold;
            color: #e74c3c;
        }
        .request-section {
            margin-top: 30px;
            padding: 20px;
            background: var(--container-bg);
            border-radius: 30px;
            box-shadow: var(--card-shadow);
            transition: background-color 0.3s ease;
        }
        .request-form {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .request-result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 30px;
            background: var(--card-bg);
            transition: background-color 0.3s ease;
        }
        .granted {
            color: #27ae60;
            font-weight: bold;
        }
        .denied {
            color: #e74c3c;
            font-weight: bold;
        }
        .graph-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .chart-container {
            background: var(--container-bg);
            padding: 15px;
            border-radius: 30px;
            box-shadow: var(--card-shadow);
            transition: background-color 0.3s ease;
        }
        .navigation-buttons {
            margin-bottom: 20px;
            display: flex;
            justify-content: center;
            gap: 10px;
        }
        .nav-button {
            background: #e74c3c;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: bold;
            transition: background 0.3s ease;
        }
        .nav-button:hover {
            background: #c0392b;
        }

        /* Mobile Responsive Design */
        @media screen and (max-width: 768px) {
            .mobile-menu-toggle {
                display: flex !important;
            }
            
            .navbar {
                display: none;
            }
            
            .container {
                margin: 10px;
                padding: 15px;
                margin-top: 80px;
            }
            
            h1 {
                font-size: 1.5em;
            }
            
            .process-inputs {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .process-card {
                padding: 10px;
            }
            
            .process-card h3 {
                font-size: 1em;
            }
            
            .graph-container {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .chart-container {
                padding: 10px;
            }
            
            .matrix-input {
                overflow-x: auto;
            }
            
            table {
                font-size: 0.8em;
            }
            
            th, td {
                padding: 4px;
                font-size: 0.8em;
            }
        }

        @media screen and (max-width: 480px) {
            .container {
                margin: 5px;
                padding: 10px;
                margin-top: 80px;
            }
            
            h1 {
                font-size: 1.3em;
                margin-bottom: 10px;
            }
            
            .input-section {
                margin-bottom: 15px;
            }
            
            input[type="number"] {
                width: 50px;
                padding: 4px 6px;
                font-size: 11px;
            }
            
            button {
                padding: 6px 12px;
                font-size: 0.85em;
                margin: 6px 0;
            }
            
            .process-inputs {
                grid-template-columns: 1fr;
                gap: 8px;
            }
            
            .process-card {
                padding: 8px;
            }
            
            .process-card h3 {
                font-size: 0.95em;
                margin-bottom: 8px;
            }
            
            .resource-input {
                margin: 6px 0;
            }
            
            .resource-input label {
                font-size: 0.8em;
                margin-bottom: 3px;
            }
            
            .resource-input input, .resource-input select {
                padding: 8px 12px;
                font-size: 11px;
            }
            
            .available-resources {
                padding: 10px;
                margin-bottom: 15px;
            }
            
            .available-resources h3 {
                font-size: 1em;
                margin-top: 0;
            }
            
            .resource-grid {
                grid-template-columns: repeat(auto-fit, minmax(80px, 1fr));
                gap: 8px;
            }
            
            .request-section {
                margin-top: 20px;
                padding: 15px;
            }
            
            .request-form {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            
            .result-section {
                margin-top: 15px;
                padding: 10px;
            }
            
            .step-by-step {
                max-height: 150px;
                padding: 8px;
                font-size: 0.8em;
            }
            
            .step {
                padding: 6px;
                margin: 3px 0;
                font-size: 0.8em;
            }
            
            .matrix-table {
                font-size: 0.75em;
                overflow-x: auto;
                display: block;
                white-space: nowrap;
            }
            
            .matrix-table th, .matrix-table td {
                padding: 3px;
                font-size: 0.75em;
            }
            
            .result-table {
                font-size: 0.8em;
                overflow-x: auto;
                display: block;
                white-space: nowrap;
            }
            
            .result-table th, .result-table td {
                padding: 6px;
                font-size: 0.8em;
            }

            .mobile-sidebar {
                width: 100%;
                left: -100%;
            }

            .mobile-menu-toggle {
                top: 15px;
                left: 15px;
                width: 45px;
                height: 45px;
                font-size: 1.3em;
                border-radius: 35px;
            }
        }
    </style>
</head>
<body>
    <!-- Mobile Menu Toggle -->
    <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">☰</button>
    
    <!-- Mobile Overlay -->
    <div class="mobile-overlay" onclick="closeMobileMenu()"></div>
    
    <!-- Mobile Sidebar -->
    <div class="mobile-sidebar" id="mobileSidebar">
      <div class="mobile-sidebar-header">
        <a href="index.html" class="mobile-sidebar-brand">OS Visualizer</a>
        <button class="mobile-close-btn" onclick="closeMobileMenu()">×</button>
      </div>
      <div class="mobile-nav-links">
        <a href="producer_consumer.html" class="mobile-nav-link">Producer-Consumer</a>
        <a href="dining_philosophers.html" class="mobile-nav-link">Dining Philosophers</a>
        <a href="readers_writers.html" class="mobile-nav-link">Readers-Writers</a>
        <a href="bankers_algorithm.html" class="mobile-nav-link active">Banker's Algorithm</a>
        <a href="memory_management.html" class="mobile-nav-link">Memory Management</a>
        <a href="resource_allocation.html" class="mobile-nav-link">Resource Allocation</a>
        <a href="Try _OS.html" class="mobile-nav-link">CPU Scheduling</a>
      </div>
      <button class="mobile-theme-toggle" onclick="toggleTheme()">🌙 Toggle Theme</button>
    </div>

    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="nav-brand">OS Visualizer</a>
            <div class="nav-links">
                <a href="producer_consumer.html" class="nav-link">Producer-Consumer</a>
                <a href="dining_philosophers.html" class="nav-link">Dining Philosophers</a>
                <a href="readers_writers.html" class="nav-link">Readers-Writers</a>
                <a href="bankers_algorithm.html" class="nav-link active">Banker's Algorithm</a>
                <a href="memory_management.html" class="nav-link">Memory Management</a>
                <a href="resource_allocation.html" class="nav-link">Resource Allocation</a>
                <a href="Try _OS.html" class="nav-link">CPU Scheduling</a>
            </div>
            <button class="theme-toggle" onclick="toggleTheme()">🌙</button>
        </div>
    </nav>

    <div class="container">
        <h1>Banker's Algorithm</h1>
        
        <div class="input-section">
            <div>
                <label for="numProcesses" style="color: var(--text-color);">Number of Processes:</label>
                <input type="number" id="numProcesses" min="1" value="5">
                
                <label for="numResources" style="margin-left: 20px; color: var(--text-color);">Number of Resources:</label>
                <input type="number" id="numResources" min="1" value="3">
                
                <button onclick="generateProcessCards()">Generate Process Cards</button>
            </div>

            <div class="available-resources">
                <h3>Available Resources</h3>
                <div class="resource-grid" id="availableResources"></div>
            </div>

            <div class="process-inputs" id="processInputs"></div>

            <button onclick="checkSafety()">Check Safety</button>
        </div>

        <div class="request-section">
            <h3>Resource Request</h3>
            <div class="request-form">
                <div>
                    <label for="requestProcess">Select Process:</label>
                    <select id="requestProcess" class="resource-input">
                        <!-- Will be populated dynamically -->
                    </select>
                </div>
                <div id="requestResources">
                    <!-- Will be populated dynamically -->
                </div>
                <button onclick="handleRequest()">Check Request</button>
            </div>
            <div id="requestResult" class="request-result" style="display: none;"></div>
        </div>

        <div class="result-section" id="resultSection" style="display: none;">
            <h2>Safety Check Results</h2>
            <div id="safetyResult"></div>
            
            <div class="graph-container">
                <div class="chart-container">
                    <canvas id="resourceUtilizationChart"></canvas>
                </div>
                <div class="chart-container">
                    <canvas id="processNeedsChart"></canvas>
                </div>
                <div class="chart-container">
                    <canvas id="safetyAnalysisChart"></canvas>
                </div>
            </div>

            <div id="matricesSection">
                <h3>Resource Matrices</h3>
                <div id="needMatrix"></div>
                <div id="workMatrix"></div>
            </div>

            <div id="stepByStep"></div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Input validation function
        function validateInput(input) {
            // Remove any non-numeric characters
            input.value = input.value.replace(/[^0-9]/g, '');
            
            // Convert to number and check if negative
            const num = parseInt(input.value);
            if (num < 0) {
                input.value = 0;
            }
        }

        // Add input validation to all number inputs
        document.addEventListener('DOMContentLoaded', function() {
            const numberInputs = document.querySelectorAll('input[type="number"]');
            numberInputs.forEach(input => {
                input.addEventListener('input', function() {
                    validateInput(this);
                });
                input.addEventListener('blur', function() {
                    validateInput(this);
                });
            });
        });

        function generateProcessCards() {
            const numProcesses = parseInt(document.getElementById('numProcesses').value);
            const numResources = parseInt(document.getElementById('numResources').value);

            // Generate Available Resources inputs
            let availableHtml = '';
            for (let i = 0; i < numResources; i++) {
                availableHtml += `
                    <div class="resource-input">
                        <label for="available_${i}">Resource R${i}</label>
                        <input type="number" id="available_${i}" min="0" value="1" oninput="validateInput(this)" onblur="validateInput(this)">
                    </div>
                `;
            }
            document.getElementById('availableResources').innerHTML = availableHtml;

            // Generate Process Cards
            const container = document.getElementById('processInputs');
            container.innerHTML = '';
            
            for (let i = 0; i < numProcesses; i++) {
                const card = document.createElement('div');
                card.className = 'process-card';
                
                let cardHtml = `<h3>Process P${i}</h3>`;
                
                // Maximum Resources
                cardHtml += '<h4>Maximum Resources</h4>';
                for (let j = 0; j < numResources; j++) {
                    cardHtml += `
                        <div class="resource-input">
                            <label for="max_${i}_${j}">Resource R${j}</label>
                            <input type="number" id="max_${i}_${j}" min="0" value="1" oninput="validateInput(this)" onblur="validateInput(this)">
                        </div>
                    `;
                }
                
                // Allocated Resources
                cardHtml += '<h4>Allocated Resources</h4>';
                for (let j = 0; j < numResources; j++) {
                    cardHtml += `
                        <div class="resource-input">
                            <label for="alloc_${i}_${j}">Resource R${j}</label>
                            <input type="number" id="alloc_${i}_${j}" min="0" value="0" oninput="validateInput(this)" onblur="validateInput(this)">
                        </div>
                    `;
                }
                
                card.innerHTML = cardHtml;
                container.appendChild(card);
            }

            // Update request process dropdown
            const requestProcess = document.getElementById('requestProcess');
            requestProcess.innerHTML = '';
            for (let i = 0; i < numProcesses; i++) {
                const option = document.createElement('option');
                option.value = i;
                option.textContent = `Process P${i}`;
                requestProcess.appendChild(option);
            }

            // Generate request resource inputs
            const requestResources = document.getElementById('requestResources');
            requestResources.innerHTML = '';
            for (let i = 0; i < numResources; i++) {
                requestResources.innerHTML += `
                    <div class="resource-input">
                        <label for="request_${i}">Resource R${i}</label>
                        <input type="number" id="request_${i}" min="0" value="0" oninput="validateInput(this)" onblur="validateInput(this)">
                    </div>
                `;
            }
        }

        function getMatrixValues() {
            const numProcesses = parseInt(document.getElementById('numProcesses').value);
            const numResources = parseInt(document.getElementById('numResources').value);

            // Get Available Resources
            const available = [];
            for (let i = 0; i < numResources; i++) {
                available.push(parseInt(document.getElementById(`available_${i}`).value));
            }

            // Get Maximum Resources
            const max = [];
            for (let i = 0; i < numProcesses; i++) {
                const row = [];
                for (let j = 0; j < numResources; j++) {
                    row.push(parseInt(document.getElementById(`max_${i}_${j}`).value));
                }
                max.push(row);
            }

            // Get Allocated Resources
            const alloc = [];
            for (let i = 0; i < numProcesses; i++) {
                const row = [];
                for (let j = 0; j < numResources; j++) {
                    row.push(parseInt(document.getElementById(`alloc_${i}_${j}`).value));
                }
                alloc.push(row);
            }

            return { available, max, alloc };
        }

        function displayMatrices(need, work, available) {
            const numProcesses = need.length;
            const numResources = available.length;
            
            // Display Need Matrix
            let needHtml = '<div class="matrix-title">Need Matrix</div><table class="matrix-table"><tr><th>Process</th>';
            for (let i = 0; i < numResources; i++) {
                needHtml += `<th>R${i}</th>`;
            }
            needHtml += '</tr>';
            
            for (let i = 0; i < numProcesses; i++) {
                needHtml += `<tr><td>P${i}</td>`;
                for (let j = 0; j < numResources; j++) {
                    needHtml += `<td>${need[i][j]}</td>`;
                }
                needHtml += '</tr>';
            }
            needHtml += '</table>';
            document.getElementById('needMatrix').innerHTML = needHtml;

            // Display Work Matrix
            let workHtml = '<div class="matrix-title">Work Matrix</div><table class="matrix-table"><tr><th>Step</th>';
            for (let i = 0; i < numResources; i++) {
                workHtml += `<th>R${i}</th>`;
            }
            workHtml += '</tr>';
            
            work.forEach((step, index) => {
                workHtml += `<tr><td>Step ${index + 1}</td>`;
                for (let j = 0; j < numResources; j++) {
                    workHtml += `<td>${step[j]}</td>`;
                }
                workHtml += '</tr>';
            });
            workHtml += '</table>';
            document.getElementById('workMatrix').innerHTML = workHtml;
        }

        function updateCharts(available, max, alloc, need, isSafe) {
            const numProcesses = max.length;
            const numResources = available.length;

            // Resource Utilization Chart
            const resourceCtx = document.getElementById('resourceUtilizationChart').getContext('2d');
            new Chart(resourceCtx, {
                type: 'bar',
                data: {
                    labels: Array.from({length: numResources}, (_, i) => `R${i}`),
                    datasets: [{
                        label: 'Available Resources',
                        data: available,
                        backgroundColor: '#e74c3c'
                    }, {
                        label: 'Total Resources',
                        data: Array.from({length: numResources}, (_, i) => 
                            available[i] + alloc.reduce((sum, row) => sum + row[i], 0)
                        ),
                        backgroundColor: '#3498db'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Resource Utilization'
                        }
                    }
                }
            });

            // Process Needs Chart
            const needsCtx = document.getElementById('processNeedsChart').getContext('2d');
            new Chart(needsCtx, {
                type: 'radar',
                data: {
                    labels: Array.from({length: numResources}, (_, i) => `R${i}`),
                    datasets: Array.from({length: numProcesses}, (_, i) => ({
                        label: `P${i}`,
                        data: need[i],
                        backgroundColor: `rgba(52, 152, 219, ${0.2 + (i * 0.1)})`,
                        borderColor: `rgba(52, 152, 219, ${0.8 + (i * 0.1)})`
                    }))
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Process Resource Needs'
                        }
                    }
                }
            });

            // Safety Analysis Chart
            const safetyCtx = document.getElementById('safetyAnalysisChart').getContext('2d');
            new Chart(safetyCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Safe', 'Unsafe'],
                    datasets: [{
                        data: [isSafe ? 1 : 0, isSafe ? 0 : 1],
                        backgroundColor: ['#27ae60', '#e74c3c']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Safety Analysis'
                        }
                    }
                }
            });
        }

        function checkSafety() {
            const { available, max, alloc } = getMatrixValues();
            const numProcesses = max.length;
            const numResources = available.length;

            // Calculate Need matrix
            const need = max.map((row, i) => 
                row.map((val, j) => val - alloc[i][j])
            );

            // Initialize work and finish arrays
            const work = [[...available]]; // Store work array at each step
            const finish = new Array(numProcesses).fill(false);
            const safeSequence = [];
            let steps = [];

            // Safety algorithm
            let found;
            do {
                found = false;
                for (let i = 0; i < numProcesses; i++) {
                    if (!finish[i]) {
                        const canAllocate = need[i].every((val, j) => val <= work[work.length - 1][j]);
                        if (canAllocate) {
                            steps.push({
                                process: i,
                                need: [...need[i]],
                                work: [...work[work.length - 1]],
                                action: 'allocate'
                            });
                            
                            // Update work and finish
                            const newWork = work[work.length - 1].map((val, j) => val + alloc[i][j]);
                            work.push(newWork);
                            finish[i] = true;
                            safeSequence.push(i);
                            found = true;
                            
                            steps.push({
                                process: i,
                                work: newWork,
                                action: 'complete'
                            });
                            break;
                        }
                    }
                }
            } while (found);

            // Check if all processes finished
            const isSafe = finish.every(val => val);
            
            // Display results
            const resultSection = document.getElementById('resultSection');
            const safetyResult = document.getElementById('safetyResult');
            const stepByStep = document.getElementById('stepByStep');
            
            resultSection.style.display = 'block';
            
            // Display safety result
            if (isSafe) {
                safetyResult.innerHTML = `
                    <table class="result-table">
                        <tr>
                            <th>System State</th>
                            <td class="safe">Safe</td>
                        </tr>
                        <tr>
                            <th>Safe Sequence</th>
                            <td>${safeSequence.map(p => `P${p}`).join(' → ')}</td>
                        </tr>
                    </table>`;
            } else {
                safetyResult.innerHTML = `
                    <table class="result-table">
                        <tr>
                            <th>System State</th>
                            <td class="unsafe">Unsafe</td>
                        </tr>
                    </table>`;
            }

            // Display matrices
            displayMatrices(need, work, available);

            // Display step-by-step execution
            stepByStep.innerHTML = '<h3>Step-by-Step Execution</h3><table class="result-table">';
            stepByStep.innerHTML += `
                <tr>
                    <th>Step</th>
                    <th>Process</th>
                    <th>Action</th>
                    <th>Details</th>
                </tr>`;
            
            steps.forEach((step, index) => {
                if (step.action === 'allocate') {
                    stepByStep.innerHTML += `
                        <tr>
                            <td class="step-number">${index + 1}</td>
                            <td>P${step.process}</td>
                            <td>Check Allocation</td>
                            <td>Need: [${step.need}]<br>Available: [${step.work}]</td>
                        </tr>`;
                } else {
                    stepByStep.innerHTML += `
                        <tr>
                            <td class="step-number">${index + 1}</td>
                            <td>P${step.process}</td>
                            <td>Complete</td>
                            <td>New Available: [${step.work}]</td>
                        </tr>`;
                }
            });
            stepByStep.innerHTML += '</table>';

            // Update charts
            updateCharts(available, max, alloc, need, isSafe);
        }

        function handleRequest() {
            const { available, max, alloc } = getMatrixValues();
            const numProcesses = max.length;
            const numResources = available.length;
            const processId = parseInt(document.getElementById('requestProcess').value);
            
            // Get request vector
            const request = [];
            for (let i = 0; i < numResources; i++) {
                request.push(parseInt(document.getElementById(`request_${i}`).value));
            }

            // Calculate Need matrix
            const need = max.map((row, i) => 
                row.map((val, j) => val - alloc[i][j])
            );

            // Check if request exceeds need
            const exceedsNeed = request.some((val, i) => val > need[processId][i]);
            if (exceedsNeed) {
                displayRequestResult(false, "Request exceeds maximum need");
                return;
            }

            // Check if request exceeds available
            const exceedsAvailable = request.some((val, i) => val > available[i]);
            if (exceedsAvailable) {
                displayRequestResult(false, "Request exceeds available resources");
                return;
            }

            // Try to allocate resources
            const newAvailable = available.map((val, i) => val - request[i]);
            const newAlloc = alloc.map((row, i) => 
                i === processId ? row.map((val, j) => val + request[j]) : row
            );

            // Check if the new state is safe
            const isSafe = checkRequestSafety(newAvailable, max, newAlloc);
            
            if (isSafe) {
                displayRequestResult(true, "Request can be granted safely");
                // Update the matrices with the new allocation
                updateMatricesAfterRequest(processId, request);
            } else {
                displayRequestResult(false, "Request cannot be granted (would lead to unsafe state)");
            }

            // Update charts after request
            const { available: newAvailableAfterRequest, max: newMax, alloc: newAllocAfterRequest } = getMatrixValues();
            const needAfterRequest = newMax.map((row, i) => 
                row.map((val, j) => val - newAllocAfterRequest[i][j])
            );
            updateCharts(newAvailableAfterRequest, newMax, newAllocAfterRequest, needAfterRequest, isSafe);
        }

        function checkRequestSafety(available, max, alloc) {
            const numProcesses = max.length;
            const numResources = available.length;
            
            // Calculate Need matrix
            const need = max.map((row, i) => 
                row.map((val, j) => val - alloc[i][j])
            );

            // Initialize work and finish arrays
            const work = [...available];
            const finish = new Array(numProcesses).fill(false);
            const safeSequence = [];

            // Safety algorithm
            let found;
            do {
                found = false;
                for (let i = 0; i < numProcesses; i++) {
                    if (!finish[i]) {
                        const canAllocate = need[i].every((val, j) => val <= work[j]);
                        if (canAllocate) {
                            work.forEach((val, j) => work[j] = val + alloc[i][j]);
                            finish[i] = true;
                            safeSequence.push(i);
                            found = true;
                            break;
                        }
                    }
                }
            } while (found);

            return finish.every(val => val);
        }

        function displayRequestResult(granted, message) {
            const resultDiv = document.getElementById('requestResult');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = `
                <table class="result-table">
                    <tr>
                        <th>Request Status</th>
                        <td class="${granted ? 'granted' : 'denied'}">${granted ? 'Granted' : 'Denied'}</td>
                    </tr>
                    <tr>
                        <th>Reason</th>
                        <td>${message}</td>
                    </tr>
                </table>
            `;
        }

        function updateMatricesAfterRequest(processId, request) {
            // Update the input fields to reflect the new allocation
            for (let i = 0; i < request.length; i++) {
                const currentAlloc = parseInt(document.getElementById(`alloc_${processId}_${i}`).value);
                document.getElementById(`alloc_${processId}_${i}`).value = currentAlloc + request[i];
                
                const currentAvailable = parseInt(document.getElementById(`available_${i}`).value);
                document.getElementById(`available_${i}`).value = currentAvailable - request[i];
            }
        }

        // Mobile menu functions
        function toggleMobileMenu() {
            const sidebar = document.getElementById('mobileSidebar');
            const overlay = document.querySelector('.mobile-overlay');
            
            sidebar.classList.add('open');
            overlay.classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        function closeMobileMenu() {
            const sidebar = document.getElementById('mobileSidebar');
            const overlay = document.querySelector('.mobile-overlay');
            
            sidebar.classList.remove('open');
            overlay.classList.remove('show');
            document.body.style.overflow = '';
        }

        // Theme toggle functionality
        function toggleTheme() {
            const body = document.body;
            const button = document.querySelector('.theme-toggle');
            const mobileButton = document.querySelector('.mobile-theme-toggle');
            
            if (body.getAttribute('data-theme') === 'dark') {
                body.removeAttribute('data-theme');
                if (button) button.innerHTML = '🌙';
                if (mobileButton) mobileButton.innerHTML = '🌙 Toggle Theme';
                localStorage.setItem('theme', 'light');
            } else {
                body.setAttribute('data-theme', 'dark');
                if (button) button.innerHTML = '☀️';
                if (mobileButton) mobileButton.innerHTML = '☀️ Toggle Theme';
                localStorage.setItem('theme', 'dark');
            }
        }

        // Load saved theme on page load
        window.addEventListener('DOMContentLoaded', function() {
            const savedTheme = localStorage.getItem('theme');
            const button = document.querySelector('.theme-toggle');
            const mobileButton = document.querySelector('.mobile-theme-toggle');
            
            if (savedTheme === 'dark') {
                document.body.setAttribute('data-theme', 'dark');
                if (button) button.innerHTML = '☀️';
                if (mobileButton) mobileButton.innerHTML = '☀️ Toggle Theme';
            }

            // Close mobile menu when clicking on a link
            const mobileLinks = document.querySelectorAll('.mobile-nav-link');
            mobileLinks.forEach(link => {
                link.addEventListener('click', closeMobileMenu);
            });
        });

        // Initialize the page
        window.onload = generateProcessCards;
    </script>
</body>
</html> 